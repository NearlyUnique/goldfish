# Feature 1: Record a New Visit - MVP Implementation Plan

## Overview

This document provides a detailed implementation plan for Feature 1: Record a New Visit (MVP). This feature allows users to quickly record visits to locations using GPS, with place suggestions from Overpass API, and store data in Firebase Firestore for the logged-in user.

## Feature Requirements Summary

- Standard Material FAB (round button with plus symbol) in lower right corner
- Built-in GPS location capture (request permissions, don't break if denied)
- Overpass API integration to find places within 20m of GPS location
- Place suggestions list from Overpass results
- User can enter place name manually
- Save visit to Firebase Firestore for logged-in user
- Display visits list on home screen (name and type)
- Default empty state: "Nothing to remember"
- Sort order: most recent first

## Architecture Overview

### Data Flow
1. User taps FAB → Opens record visit screen
2. Location service requests permission and captures GPS location
3. Overpass API query finds places within 20m of GPS location
4. Display place suggestions list to user
5. User selects from suggestions OR enters place name manually
6. Save button → Visit repository → Firebase Firestore (user's collection)
7. Success feedback → Navigate back to home
8. Home screen displays visits list (most recent first)

### Component Structure
```
lib/
├── core/
│   ├── data/
│   │   ├── models/
│   │   │   ├── visit_model.dart
│   │   │   └── place_suggestion_model.dart
│   │   └── repositories/
│   │       └── visit_repository.dart
│   ├── location/
│   │   └── location_service.dart
│   └── api/
│       ├── overpass_client.dart
│       └── http_client.dart
└── features/
    └── visits/
        ├── domain/
        │   └── view_models/
        │       └── record_visit_view_model.dart
        └── presentation/
            ├── screens/
            │   ├── record_visit_screen.dart
            │   └── home_screen.dart (update existing)
            └── widgets/
                └── place_suggestions_list.dart
```

### Data Model (Firestore)

**Visit Document Structure**:
- `id`: String (auto-generated by Firestore)
- `userId`: String (logged-in user's UID)
- `placeName`: String (required)
- `placeAddress`: String? (from Overpass or geocoding)
- `recordedGpsLatitude`: double (user's GPS when recording)
- `recordedGpsLongitude`: double (user's GPS when recording)
- `placeGpsLatitude`: double? (from Overpass, if available)
- `placeGpsLongitude`: double? (from Overpass, if available)
- `amenityType`: String? (from Overpass tags: amenity, tourism, historic, leisure, shop, craft, office, public_transport)
- `addedAt`: Timestamp (date and time visit was added)
- `createdAt`: Timestamp (auto-generated)
- `updatedAt`: Timestamp (auto-generated)

**Firestore Collection Structure**:
- Collection: `visits`
- Document ID: Auto-generated
- Query: Filter by `userId` to get user's visits
- Index: On `userId` and `addedAt` for efficient queries

## Implementation Tasks

### Task 1: Set Up Dependencies
**Priority**: Critical
**Estimated Time**: 15 minutes

**Description**: Add required packages to `pubspec.yaml`.

**Dependencies to Add**:
- `geolocator` - Location services (GPS, permissions)
- `http` - HTTP client for Overpass API (testable)

**Note**: Firebase packages (`cloud_firestore`, `firebase_core`) are already installed.

**Files to Modify**:
- `pubspec.yaml`

**Commands**:
```bash
flutter pub add geolocator http
```

**Deliverables**:
- Updated `pubspec.yaml` with dependencies
- Packages installed and ready to use

---

### Task 2: Create Visit Data Model
**Priority**: Critical
**Estimated Time**: 30 minutes

**Description**: Create the `Visit` model class for MVP with Firestore integration.

**Requirements**:
- All fields matching Firestore document structure
- Firestore serialization/deserialization
- Immutable class with `copyWith` method
- Proper null safety handling
- Validation for required fields

**Files to Create**:
- `lib/core/data/models/visit_model.dart`

**Model Structure**:
```dart
class Visit {
  final String? id; // Firestore document ID (null for new visits)
  final String userId; // Logged-in user's UID
  final String placeName; // Required
  final String? placeAddress;
  final double recordedGpsLatitude; // User's GPS when recording
  final double recordedGpsLongitude;
  final double? placeGpsLatitude; // From Overpass
  final double? placeGpsLongitude; // From Overpass
  final String? amenityType; // From Overpass tags
  final DateTime addedAt; // Date/time visit was added
  final DateTime createdAt;
  final DateTime updatedAt;

  // Constructors, copyWith, toFirestore, fromFirestore, etc.
}
```

**Considerations**:
- Use `cloud_firestore` Timestamp for Firestore dates
- Convert between DateTime and Timestamp
- ID is null for new visits (Firestore generates it)
- userId must match logged-in user
- Include validation methods

**Deliverables**:
- Complete `Visit` model class
- Firestore serialization/deserialization
- Unit tests for model

---

### Task 3: Create Place Suggestion Model
**Priority**: High
**Estimated Time**: 20 minutes

**Description**: Create model for Overpass API place suggestions.

**Requirements**:
- Parse Overpass API response
- Extract place information (name, type, coordinates, address)
- Handle different Overpass element types (node, way, relation)

**Files to Create**:
- `lib/core/data/models/place_suggestion_model.dart`

**Model Structure**:
```dart
class PlaceSuggestion {
  final String name;
  final String? amenityType; // amenity, tourism, historic, leisure, shop, craft, office, public_transport
  final double latitude;
  final double longitude;
  final String? address; // From tags (addr:street, addr:housenumber, etc.)
  final Map<String, String> tags; // All Overpass tags

  // Constructors, fromOverpassJson, etc.
}
```

**Considerations**:
- Overpass returns different structures for node/way/relation
- Extract center coordinates for ways/relations
- Parse address from addr:* tags
- Handle missing name gracefully

**Deliverables**:
- Place suggestion model
- Overpass JSON parsing
- Unit tests

---

### Task 4: Create Testable HTTP Client
**Priority**: High
**Estimated Time**: 30 minutes

**Description**: Create abstract HTTP client interface for testability.

**Requirements**:
- Abstract interface for HTTP operations
- Concrete implementation using `http` package
- Testable (can be mocked in tests)
- Dependency injection support

**Files to Create**:
- `lib/core/api/http_client.dart`

**Interface**:
```dart
abstract class HttpClient {
  Future<Response> post(
    Uri url, {
    Map<String, String>? headers,
    Object? body,
  });
}

class HttpPackageClient implements HttpClient {
  final http.Client _client;
  // Implementation using http package
}
```

**Considerations**:
- Use dependency injection pattern
- Allow swapping implementation for tests
- Handle errors consistently
- Support custom headers

**Deliverables**:
- HTTP client interface
- Concrete implementation
- Unit tests with mocks

---

### Task 5: Create Overpass API Client
**Priority**: High
**Estimated Time**: 1-2 hours

**Description**: Create client for querying Overpass API to find nearby places.

**Requirements**:
- Build Overpass query for places within 20m
- Query nodes, ways, and relations
- Filter by amenity/tourism/historic/leisure/shop/craft/office/public_transport
- Parse response into PlaceSuggestion models
- Handle API errors gracefully
- Testable (uses HttpClient interface)

**Files to Create**:
- `lib/core/api/overpass_client.dart`

**Service Methods**:
- `findNearbyPlaces(double latitude, double longitude, {double radiusMeters = 20})` - Find places within radius
- `_buildQuery(double lat, double lon, double radius)` - Build Overpass query string
- `_parseResponse(String jsonResponse)` - Parse Overpass JSON response

**Overpass Query**:
```
[out:json][timeout:25];
(
  node(around:20,{lat},{lon})[~"^(amenity|tourism|historic|leisure|shop|craft|office|public_transport)$"~"."];
  way(around:20,{lat},{lon})[~"^(amenity|tourism|historic|leisure|shop|craft|office|public_transport)$"~"."];
  relation(around:20,{lat},{lon})[~"^(amenity|tourism|historic|leisure|shop|craft|office|public_transport)$"~"."];
);
out center tags;
```

**API Endpoint**: `https://overpass-api.de/api/interpreter`

**Considerations**:
- Use testable HttpClient
- Handle network errors
- Handle empty results
- Extract center coordinates for ways/relations
- Filter may need to be config-driven later (but not now - hardcode it)
- Timeout handling

**Deliverables**:
- Overpass API client
- Query building
- Response parsing
- Error handling
- Unit tests with mocked HTTP client

---

### Task 6: Create Location Service
**Priority**: High
**Estimated Time**: 1-2 hours

**Description**: Create service for location permissions and GPS location capture.

**Requirements**:
- Request location permissions
- Get current GPS location
- Handle permission denied gracefully (don't break app)
- Handle location unavailable scenarios
- Location accuracy settings

**Files to Create**:
- `lib/core/location/location_service.dart`

**Service Methods**:
- `requestPermission()` - Request location permission
- `hasPermission()` - Check if permission granted
- `getCurrentLocation()` - Get current GPS coordinates (returns null if permission denied)
- `isLocationServiceEnabled()` - Check if location services enabled

**Considerations**:
- Use `geolocator` package
- Handle Android 13+ permission model
- Request foreground location permission
- Don't crash if permission denied - return null gracefully
- Provide clear error messages
- Handle timeouts gracefully

**Deliverables**:
- Location service implementation
- Permission handling (graceful degradation)
- Error handling
- Unit tests

---

### Task 7: Create Visit Repository
**Priority**: Critical
**Estimated Time**: 1 hour

**Description**: Create repository layer for Firestore visit operations.

**Requirements**:
- Create visit in Firestore (user's collection)
- Get user's visits (filtered by userId)
- Query visits ordered by most recent
- Error handling and transformation

**Files to Create**:
- `lib/core/data/repositories/visit_repository.dart`

**Repository Methods**:
- `createVisit(Visit visit)` - Create and save visit to Firestore
- `getUserVisits(String userId)` - Get all visits for user (ordered by addedAt desc)
- `getVisitById(String id, String userId)` - Get single visit (verify ownership)

**Firestore Structure**:
- Collection: `visits`
- Query: `where('userId', isEqualTo: userId).orderBy('addedAt', descending: true)`
- Index: Composite index on `userId` and `addedAt`

**Considerations**:
- Repository pattern for testability
- Dependency injection of Firestore instance
- Proper error handling and exceptions
- Verify userId matches logged-in user
- Set createdAt/updatedAt timestamps automatically

**Deliverables**:
- Visit repository implementation
- Firestore integration
- Error handling
- Unit tests with mocked Firestore

---

### Task 8: Create Record Visit ViewModel
**Priority**: High
**Estimated Time**: 1-2 hours

**Description**: Create ViewModel for managing record visit screen state and business logic.

**Requirements**:
- Manage form state (place name, selected place suggestion)
- Handle location capture
- Handle Overpass API queries
- Manage place suggestions list
- Validate form data
- Save visit to repository
- Handle loading and error states

**Files to Create**:
- `lib/features/visits/domain/view_models/record_visit_view_model.dart`

**State Management**:
- Use `ChangeNotifier` for state management
- Expose state properties (placeName, currentLocation, suggestions, selectedSuggestion, etc.)
- Expose loading/error states
- Provide methods for user actions

**ViewModel Methods**:
- `initialize()` - Initialize and get current location, then query Overpass
- `refreshLocation()` - Re-fetch location and update suggestions
- `selectSuggestion(PlaceSuggestion suggestion)` - Select a place from suggestions
- `updatePlaceName(String name)` - Update place name (manual entry)
- `saveVisit()` - Save visit to repository
- `cancel()` - Cancel and discard changes

**State Properties**:
- `currentLocation`: Position? (GPS location)
- `suggestions`: List<PlaceSuggestion> (from Overpass)
- `selectedSuggestion`: PlaceSuggestion? (user's selection)
- `placeName`: String (manual entry or from suggestion)
- `isLoadingLocation`: bool
- `isLoadingSuggestions`: bool
- `isSaving`: bool
- `error`: String? (error message)

**Considerations**:
- Handle async operations (location, Overpass API, saving)
- Provide loading indicators
- Handle errors gracefully (permission denied, network errors)
- Validate required fields before save (placeName, location)
- Auto-set addedAt to current time
- Get userId from AuthNotifier

**Deliverables**:
- ViewModel implementation
- State management
- Error handling
- Unit tests

---

### Task 9: Create Place Suggestions List Widget
**Priority**: High
**Estimated Time**: 1 hour

**Description**: Create widget for displaying Overpass API place suggestions.

**Requirements**:
- Display list of place suggestions
- Show place name, type, and address (if available)
- Allow user to select a suggestion
- Show loading state while fetching
- Show empty state if no suggestions
- Handle tap to select suggestion

**Files to Create**:
- `lib/features/visits/presentation/widgets/place_suggestions_list.dart`

**UI Components**:
- ListView of suggestion cards
- Each card shows:
  - Place name (prominent)
  - Amenity type (chip/badge)
  - Address (if available, smaller text)
- Loading indicator
- Empty state message
- Error state message

**Considerations**:
- Use Material 3 ListTile or Card widgets
- Show amenity type as chip with icon
- Highlight selected suggestion
- Responsive design
- Accessible (semantics)

**Deliverables**:
- Place suggestions list widget
- Selection handling
- Loading/empty/error states
- Widget tests

---

### Task 10: Create Record Visit Screen
**Priority**: Critical
**Estimated Time**: 2-3 hours

**Description**: Create main screen for recording a visit with place suggestions and manual entry.

**Requirements**:
- Display current location status
- Show place suggestions list (if location available)
- Allow manual place name entry
- Save button
- Cancel button
- Loading states
- Error handling
- Success feedback (SnackBar)
- Responsive design

**Files to Create**:
- `lib/features/visits/presentation/screens/record_visit_screen.dart`

**UI Layout**:
- AppBar with title "Record Visit" and cancel button
- Scrollable body:
  1. Location status section (shows GPS coordinates or "Location unavailable")
  2. Place suggestions list widget (if suggestions available)
  3. Divider with "OR" text
  4. Manual entry section:
     - Text field for place name (required)
     - Optional: Show selected suggestion details
- Bottom action bar with Save button (disabled if no place name)

**Form Validation**:
- Place name required (show error if empty)
- Location required (latitude/longitude must be set)
- Disable save button if validation fails

**User Flow**:
1. Screen opens → Auto-get current location
2. If location available → Query Overpass API for suggestions
3. User either:
   - Selects from suggestions list, OR
   - Enters place name manually
4. User taps Save → Validate → Save to Firestore → Show success → Navigate back
5. User taps Cancel → Discard changes → Navigate back

**Considerations**:
- Use `Scaffold` with `SingleChildScrollView`
- Material 3 design
- Support light/dark themes
- Large touch targets (48x48 minimum)
- Keyboard handling (dismiss on scroll)
- Loading overlay during save
- Error SnackBar for failures
- Success SnackBar with confirmation

**Deliverables**:
- Complete record visit screen
- Form validation
- Error handling
- Success feedback
- Responsive layout
- Widget tests

---

### Task 11: Update Home Screen to Display Visits List
**Priority**: Critical
**Estimated Time**: 1-2 hours

**Description**: Update home screen to display user's visits list.

**Requirements**:
- Display list of user's visits
- Show place name and amenity type for each visit
- Sort by most recent first (addedAt descending)
- Show empty state: "Nothing to remember"
- Pull-to-refresh to reload visits
- Add FAB (round button with plus) in lower right corner

**Files to Modify**:
- `lib/features/home/presentation/screens/home_screen.dart`

**UI Layout**:
- AppBar with title "Goldfish" and sign-out button
- Body:
  - If visits empty: Center with "Nothing to remember" text
  - If visits exist: ListView of visit cards
- FloatingActionButton: Round button with plus icon in lower right

**Visit List Item**:
- Card or ListTile showing:
  - Place name (prominent)
  - Amenity type (chip/badge, if available)
  - Date added (formatted: "2 days ago", "Jan 15, 2024")

**Considerations**:
- Use `ListView.builder` for performance
- Listen to visits stream from repository
- Handle loading state
- Handle error state
- Material 3 FAB styling
- Responsive design

**Deliverables**:
- Updated home screen
- Visits list display
- Empty state
- FAB navigation
- Widget tests

---

### Task 12: Add Navigation Route
**Priority**: High
**Estimated Time**: 15 minutes

**Description**: Add route for record visit screen in app router.

**Requirements**:
- Add `/record-visit` route
- Ensure route is accessible to authenticated users only

**Files to Modify**:
- `lib/core/router/app_router.dart`

**Route Configuration**:
```dart
GoRoute(
  path: '/record-visit',
  name: 'record-visit',
  builder: (context, state) => RecordVisitScreen(),
),
```

**Home Screen Updates**:
- FAB already added in Task 11
- FAB navigates to `/record-visit` using `context.push('/record-visit')`

**Deliverables**:
- Route added to router
- Navigation from FAB
- Deep linking support

---

### Task 13: Add Permissions to AndroidManifest
**Priority**: Critical
**Estimated Time**: 15 minutes

**Description**: Add required permissions to Android manifest.

**Required Permissions**:
- `ACCESS_FINE_LOCATION` - For GPS location
- `ACCESS_COARSE_LOCATION` - For approximate location (optional, for better compatibility)
- `INTERNET` - For Overpass API calls (usually already present)

**Files to Modify**:
- `android/app/src/main/AndroidManifest.xml`

**Considerations**:
- Android 13+ uses different permission model
- Request permissions at runtime (handled by geolocator)
- Handle permission denied gracefully (don't break app)

**Deliverables**:
- Updated AndroidManifest.xml
- Permissions declared

---

### Task 14: Implement Success Feedback
**Priority**: Medium
**Estimated Time**: 30 minutes

**Description**: Implement confirmation feedback after successful visit save.

**Requirements**:
- Show SnackBar with success message
- Navigate back to home screen
- Brief haptic feedback (optional)

**Implementation**:
- Use `ScaffoldMessenger` to show SnackBar
- Message: "Visit recorded successfully" or similar
- Auto-dismiss after 2-3 seconds
- Navigate back using `context.pop()` or `go_router` navigation

**Deliverables**:
- Success feedback implementation
- User-friendly messages

---

### Task 15: Error Handling and Edge Cases
**Priority**: High
**Estimated Time**: 1-2 hours

**Description**: Handle all error scenarios and edge cases.

**Error Scenarios**:
- Location permission denied (don't break - show message, allow manual entry)
- Location services disabled
- Location unavailable/timeout
- Overpass API network errors
- Overpass API timeout
- Firestore save failed
- No internet connection (Firestore operations)

**Error Handling Strategy**:
- Show user-friendly error messages
- Provide actionable guidance
- Don't block user from continuing (where possible)
- Log errors for debugging
- Graceful degradation (e.g., allow manual entry if location fails)

**Edge Cases**:
- User cancels location request
- No places found in Overpass results (show empty state)
- User enters place name but no location available
- Multiple rapid saves
- Very long place names
- Network timeout during Overpass query

**Deliverables**:
- Comprehensive error handling
- User-friendly error messages
- Edge case handling

---

### Task 16: Testing
**Priority**: High
**Estimated Time**: 2-3 hours

**Description**: Write unit tests, widget tests, and integration tests.

**Unit Tests**:
- Visit model (Firestore serialization, validation)
- Place suggestion model (Overpass parsing)
- Visit repository (Firestore operations)
- Overpass client (query building, response parsing)
- HTTP client (testable interface)
- Location service (permissions, location)
- ViewModel (state management, business logic)

**Widget Tests**:
- Record visit screen
- Place suggestions list widget
- Home screen (visits list, empty state)

**Integration Tests**:
- Complete flow: Open screen → Get location → Get suggestions → Select/enter place → Save → Verify in Firestore

**Files to Create**:
- `test/core/data/models/visit_model_test.dart`
- `test/core/data/models/place_suggestion_model_test.dart`
- `test/core/data/repositories/visit_repository_test.dart`
- `test/core/api/overpass_client_test.dart`
- `test/core/api/http_client_test.dart`
- `test/core/location/location_service_test.dart`
- `test/features/visits/domain/view_models/record_visit_view_model_test.dart`
- `test/features/visits/presentation/screens/record_visit_screen_test.dart`
- `test/features/visits/presentation/widgets/place_suggestions_list_test.dart`
- `test/features/home/presentation/screens/home_screen_test.dart`

**Deliverables**:
- Comprehensive test coverage
- All tests passing
- Test documentation

---

### Task 17: Set Up Firestore Indexes
**Priority**: High
**Estimated Time**: 15 minutes

**Description**: Create Firestore composite index for efficient queries.

**Requirements**:
- Create composite index on `visits` collection
- Index fields: `userId` (ascending) and `addedAt` (descending)
- Required for querying user's visits sorted by date

**Firestore Console Steps**:
1. Go to Firebase Console → Firestore Database → Indexes
2. Click "Create Index"
3. Collection ID: `visits`
4. Add fields:
   - `userId` (Ascending)
   - `addedAt` (Descending)
5. Click "Create"

**Alternative (Auto-generated)**:
- Firestore will suggest creating the index when the query is first run
- Follow the link in the error message to create it

**Deliverables**:
- Firestore composite index created
- Efficient querying enabled

---


---


---

## Implementation Order

### Phase 1: Foundation (Critical Path)
1. Task 1: Set Up Dependencies
2. Task 2: Create Visit Data Model
3. Task 3: Create Place Suggestion Model
4. Task 4: Create Testable HTTP Client
5. Task 13: Add Permissions to AndroidManifest

### Phase 2: Services
6. Task 5: Create Overpass API Client
7. Task 6: Create Location Service
8. Task 7: Create Visit Repository

### Phase 3: ViewModel and UI Components
9. Task 8: Create Record Visit ViewModel
10. Task 9: Create Place Suggestions List Widget

### Phase 4: Main Screen and Navigation
11. Task 10: Create Record Visit Screen
12. Task 11: Update Home Screen to Display Visits List
13. Task 12: Add Navigation Route
14. Task 14: Implement Success Feedback

### Phase 5: Polish
15. Task 15: Error Handling and Edge Cases
16. Task 16: Testing
17. Task 17: Set Up Firestore Indexes

## Technical Considerations

### Permissions Handling
- Request permissions at runtime using geolocator
- Handle permission denied gracefully - don't break the app
- Show user-friendly message if permission denied
- Allow manual place entry even if location unavailable
- Don't show error dialogs that block the user

### Overpass API
- Use testable HTTP client for Overpass queries
- Handle network errors gracefully
- Handle timeout (25 seconds default)
- Filter hardcoded for now (may be config-driven later)
- Query radius: 20 meters (hardcoded)
- Extract center coordinates for ways/relations

### Firestore
- Store visits in `visits` collection
- Filter by `userId` to get user's visits
- Sort by `addedAt` descending (most recent first)
- Create composite index for efficient queries
- Handle offline mode (Firestore SDK handles this)

### Performance
- Efficient Firestore queries with proper indexes
- Don't block UI on async operations (location, API calls)
- Show loading states appropriately
- Cache Overpass results if needed (future optimization)

### Accessibility
- Semantic labels for all interactive elements
- Screen reader support
- High contrast support
- Clear error messages

### Responsive Design
- Works on all screen sizes (phone, tablet, foldable)
- Adapts to portrait/landscape
- Efficient use of screen space
- Touch targets minimum 48x48
- Standard Material 3 FAB in lower right corner

## Success Criteria

- [ ] User can tap FAB (round button with plus) to open record visit screen
- [ ] App requests location permission (doesn't break if denied)
- [ ] Current GPS location is automatically captured (if permission granted)
- [ ] Overpass API finds places within 20m and displays suggestions
- [ ] User can select a place from suggestions list
- [ ] User can enter place name manually (required field)
- [ ] Form validates required fields (place name, location)
- [ ] Visit is saved to Firestore for logged-in user with all required data:
  - [ ] Date and time it was added
  - [ ] Recorded GPS coordinates
  - [ ] Place GPS from Overpass (if available)
  - [ ] Amenity type (if available)
  - [ ] Physical address (if available)
- [ ] Success feedback is shown (SnackBar)
- [ ] User is navigated back to home after save
- [ ] Home screen displays visits list (name and type)
- [ ] Empty state shows "Nothing to remember" when no visits
- [ ] Visits sorted by most recent first
- [ ] All error scenarios are handled gracefully (permission denied, network errors, etc.)
- [ ] Feature is responsive to all screen sizes
- [ ] HTTP client is testable (can be mocked)
- [ ] Tests are written and passing

## Notes

- This is an MVP implementation - keep it simple
- Overpass filter is hardcoded for now (may be config-driven later)
- HTTP client should be testable for unit tests
- Use standard Material 3 FAB (round button with plus icon) in lower right
- Don't break if location permission denied - allow manual entry
- Firestore handles offline mode automatically (queues writes)
- Test on real Android devices (not just emulator) for GPS and permissions
- Overpass API endpoint: `https://overpass-api.de/api/interpreter`
- Query timeout: 25 seconds (Overpass default)
- Search radius: 20 meters (hardcoded for MVP)

